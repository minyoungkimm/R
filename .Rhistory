curr_PageOldNum <- 0
pageLink <- NULL
reple <- 0
curr_PageOldNum <- 0
repeat{
doms <- remDr$findElements(using = "css selector", ".review_desc > p")
Sys.sleep(1)
reple_v <- sapply(doms, function (x) {x$getElementText()})
print(reple_v)
un_v <- unlist(reple_v)
if(reple[length(reple)] == un_v[length(un_v)]){
break
}
reple <- append(reple, un_v)
cat(length(reple), "\n")
#curr_PageElem <- remDr$findElement(using='css',"span > strong.ng-binding")
#curr_PageNewNum <- as.numeric(curr_PageElem$getElementText())
#cat(paste(curr_PageOldNum, ':', curr_PageNewNum,'\n'))
#if(curr_PageNewNum == curr_PageOldNum)  {
#  cat("종료\n")
#  break;
#}
#curr_PageOldNum <- curr_PageNewNum;
pageLink <- remDr$findElements(using='css','.review_ta.ng-scope > div.paginate > a.direction.next')
remDr$executeScript("arguments[0].click();",pageLink)
}
pageLink <- NULL
reple <- 0
curr_PageOldNum <- 0
repeat{
doms <- remDr$findElements(using = "css selector", ".review_desc > p")
Sys.sleep(1)
reple_v <- sapply(doms, function (x) {x$getElementText()})
print(reple_v)
un_v <- unlist(reple_v)
if(reple[length(reple)] == un_v[length(un_v)]){
break
reple <- reple[-1]
}
reple <- append(reple, un_v)
cat(length(reple), "\n")
#curr_PageElem <- remDr$findElement(using='css',"span > strong.ng-binding")
#curr_PageNewNum <- as.numeric(curr_PageElem$getElementText())
#cat(paste(curr_PageOldNum, ':', curr_PageNewNum,'\n'))
#if(curr_PageNewNum == curr_PageOldNum)  {
#  cat("종료\n")
#  break;
#}
#curr_PageOldNum <- curr_PageNewNum;
pageLink <- remDr$findElements(using='css','.review_ta.ng-scope > div.paginate > a.direction.next')
remDr$executeScript("arguments[0].click();",pageLink)
}
cat(length(reple), "개의 댓글 추출\n")
reple
reple[-1]
cat(length(reple), "개의 댓글 추출\n")
cat(length(reple[-1]), "개의 댓글 추출\n")
write(reple[-1],"naverhotel.txt")
library(RSelenium)
install.packages("base64enc")
install.packages("magick")
library(RSelenium)
remDr <- remoteDriver(remoteServerAddr = "localhost" , port = 4445, browserName = "chrome")
remDr$open()
# 이해를 돕기 위해 간단한 웹페이지를 크롤링하고 스크래핑 함
url <- "http://unico2013.dothome.co.kr/crawling/tagstyle.html"
remDr$navigate(url)
#단수형으로 노드 추출 using=css 나 using=css selector 나 동일함
one<-remDr$findElement(using='css','div') # 노드 한 개 리턴(webElement 객체)
one$getElementTagName()
one$getElementText()
# 단수형으로 없는 노드 추출
one<-NULL
one<-remDr$findElement(using='css','p') # 없으면 오류 발생
# 만일 오류 발생을 무시하고 싶어서 사용하지만 소용없음, 외부 라이브러리 사용 때문이라 추정(^^)
# 없을 수도 있으면 복수형(findElements()) 사용할것
one<-NULL
try(one<-remDr$findElement(using='css','p'))
#복수형으로 노드 추출
more<-remDr$findElements(using='css','div')
sapply(more, function(x) x$getElementTagName())
sapply(more, function(x) x$getElementText())
#복수형으로 없는 추출
more<-remDr$findElements(using='css','p') # 없으면 오류가 발생하지 않음 비어있는 리스트 리턴
print(more)
if(length(more) == 0)
cat("<p> 태그는 없슈\n")
sapply(more, function(x) x$getElementTagName())
sapply(more, function(x) x$getElementText())
library(base64enc)
library(magick)
remDr <- remoteDriver(remoteServerAddr = "localhost", port=4445, browserName="chrome")
remDr$open()
remDr$navigate("https://google.com")
# this returns a list of base64 characters
screenshot <- remDr$screenshot(display = FALSE)
# converts the base64 characters into a vector
screenshot <- base64decode(toString(screenshot), output = NULL)
# reads the vector as stores it as a PNG
screenshot <- image_read(screenshot)
image_browse(screenshot)
remDr$screenshot(display = FALSE, file="c:/Temp/google.png")
pngdata <- image_read("c:/Temp/google.png")
image_browse(pngdata)
site <- "https://book.naver.com/"
remDr$navigate(site)
booksitenodes <- remDr$findElements(using='css', '#bestseller_tab > ul.tab_cp_spt > li > a')
booksites <- sapply(booksitenodes, function(x) {x$getElementAttribute("class")})
booksites <- unlist(booksites);
booksites <- unlist(strsplit(booksites, ' '))
size <- length(booksites)
booksites <- booksites[seq(1, size, 2)]
for (booksite in booksites) {
booksitenode <- remDr$findElement(using='css', paste0('#tab_cp_spt_',booksite))
booksitenode$clickElement()
Sys.sleep(2)
bookthumbenodes <- remDr$findElements(using='css', '#bestseller_list dl>dt:nth-child(1) img')
bookthumburl <- sapply(bookthumbenodes, function(x) {x$getElementAttribute("src")})
bookthumburl <- unlist(bookthumburl)
booktitlenodes <- remDr$findElements(using='css', '#bestseller_list dl>dt:nth-child(2)>a')
booktitle <- sapply(booktitlenodes, function(x) {x$getElementText()})
booktitle <- gsub("[[:cntrl:]]", "", booktitle)
df <- data.frame(bookthumburl, booktitle)
if (!dir.exists('book'))
dir.create('book')
print(df)
write.csv(df, file=paste0('book/', booksite, '.csv'))
}
booksites
booksites
booksitenodes <- remDr$findElements(using='css', '#bestseller_tab > ul.tab_cp_spt > li > a')
booksites <- sapply(booksitenodes, function(x) {x$getElementAttribute("class")})
booksites <- unlist(booksites);
booksites
booksites <- unlist(strsplit(booksites, ' '))
booksites
size <- length(booksites)
booksites <- booksites[seq(1, size, 2)]
site <- 'http://gs25.gsretail.com/gscvs/ko/products/event-goods'
remDr$navigate(site)
eventgoodsnodes <- remDr$findElements(using='css', '#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(3) > ul > li > div > p.tit')
eventgoodsname <- sapply(eventgoodsnodes, function(x) {x$getElementText()})
eventgoodsnodes <- remDr$findElements(using='css', '#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(3) > ul > li > div > p.price > span')
eventgoodsprice <- sapply(eventgoodsnodes, function(x) {x$getElementText()})
remDr <- remoteDriver(remoteServerAddr = "localhost", port = 4445, browserName = "chrome")
remDr$open()
remDr$navigate("http://www.yes24.com/24/goods/40936880")
#webElem <- remDr$findElement("css", "body")
#remDr$executeScript("scrollTo(0, 0)", args = list(webElem))
#Sys.sleep(1)
#remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
#Sys.sleep(1)
#remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
#Sys.sleep(1)
#remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
#Sys.sleep(3)
repl_v = NULL
endFlag <- FALSE
page <- 3
site <- "https://book.naver.com/"
remDr$navigate(site)
site <- 'http://gs25.gsretail.com/gscvs/ko/products/event-goods'
remDr$navigate(site)
eventgoodsnodes <- remDr$findElements(using='css', '#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(3) > ul > li > div > p.tit')
eventgoodsname <- sapply(eventgoodsnodes, function(x) {x$getElementText()})
eventgoodsname
eventgoodsnodes <- remDr$findElements(using='css', '#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(3) > ul > li > div > p.price > span')
eventgoodsprice <- sapply(eventgoodsnodes, function(x) {x$getElementText()})
eventgoodsprice
url <- "http://gs25.gsretail.com/gscvs/ko/products/event-goods"
remDr$navigate(url)
twotoone <- remDr$findElements(using='css', '#TWO_TO_ONE')
twotoone$clickElement()
twotoone
twotoone <- remDr$findElements(using='css', '#contents > div.cnt > div.cnt_section.mt50 > div > div > ul > li:nth-child(2) > span')
twotoone$clickElement()
twotoone <- remDr$findElements(using='css', '#TWO_TO_ONE')
twotoone$clickElement()
twotoone <- remDr$findElements(using='css', '#TWO_TO_ONE')
remDr$executeScript("arguments[0].click();",twotoone)
doms <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
name <- sapply(doms, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
name
doms <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
name <- sapply(doms, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
goodsname <- append(goodsname, name)
goodsname <- NULL
goodsname <- append(goodsname, name)
cat(length(goodsname), "\n")
# 상품 가격
dom_price <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.price > span")
price <- sapply(dom_price, function (x) {x$getElementText()})
price <- gsub("[^0-9]", "", price)
print(price)
class(price)
is.list(price)
is.vector(price)
goodsname <- NULL;goodsprice <- NULL
# 상품명
dom_name <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
name <- sapply(dom_name, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
goodsname <- append(goodsname, name)
cat(length(goodsname), "\n")
# 상품 가격
dom_price <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.price > span")
price <- sapply(dom_price, function (x) {x$getElementText()})
price <- gsub("[^0-9]", "", price)
print(price)
goodsprice <- append(goodsprice, name)
cat(length(goodsprice), "\n")
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
curr_PageNewNum <- as.numeric(curr_PageElem$getElementText())
curr_PageNewNum
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
PageNewNum <- as.numeric(curr_PageElem$getElementText())
PageNewNum
goodsname <- NULL;goodsprice <- NULL;PageOldNum <- 1
remDr$navigate(url)
twotoone <- remDr$findElements(using='css', '#TWO_TO_ONE')
remDr$executeScript("arguments[0].click();",twotoone)
goodsname <- NULL;goodsprice <- NULL;PageOldNum <- 1
repeat{
# 상품명
dom_name <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
Sys.sleep(1)
name <- sapply(dom_name, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
goodsname <- append(goodsname, name)
cat(length(goodsname), "\n")
# 상품 가격
dom_price <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.price > span")
Sys.sleep(1)
price <- sapply(dom_price, function (x) {x$getElementText()})
price <- gsub("[^0-9]", "", price)
print(price)
goodsprice <- append(goodsprice, name)
cat(length(goodsprice), "\n")
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
PageNewNum <- as.numeric(curr_PageElem$getElementText())
if(PageNewNum == PageOldNum)  {
cat("종료\n")
break;
}
PageOldNum <- PageNewNum
}
remDr$navigate(url)
twotoone <- remDr$findElements(using='css', '#TWO_TO_ONE')
remDr$executeScript("arguments[0].click();",twotoone)
goodsname <- NULL;goodsprice <- NULL;PageOldNum <- 1
repeat{
# 상품명
dom_name <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
Sys.sleep(1)
name <- sapply(dom_name, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
goodsname <- append(goodsname, name)
cat(length(goodsname), "\n")
# 상품 가격
dom_price <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.price > span")
Sys.sleep(1)
price <- sapply(dom_price, function (x) {x$getElementText()})
price <- gsub("[^0-9]", "", price)
print(price)
goodsprice <- append(goodsprice, name)
cat(length(goodsprice), "\n")
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
PageNewNum <- as.numeric(curr_PageElem$getElementText())
if(PageNewNum == PageOldNum)  {
cat("종료\n")
break;
}
PageOldNum <- PageNewNum
}
library(RSelenium)
remDr <- remoteDriver(remoteServerAddr = "localhost" , port = 4445, browserName = "chrome")
remDr$open()
url <- "http://gs25.gsretail.com/gscvs/ko/products/event-goods"
remDr$navigate(url)
twotoone <- remDr$findElements(using='css', '#TWO_TO_ONE')
remDr$executeScript("arguments[0].click();",twotoone)
goodsname <- NULL;goodsprice <- NULL;PageOldNum <- 1
repeat{
# 상품명
dom_name <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
Sys.sleep(1)
name <- sapply(dom_name, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
goodsname <- append(goodsname, name)
cat(length(goodsname), "\n")
# 상품 가격
dom_price <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.price > span")
Sys.sleep(1)
price <- sapply(dom_price, function (x) {x$getElementText()})
price <- gsub("[^0-9]", "", price)
print(price)
goodsprice <- append(goodsprice, name)
cat(length(goodsprice), "\n")
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
PageNewNum <- as.numeric(curr_PageElem$getElementText())
if(PageNewNum == PageOldNum)  {
cat("종료\n")
break;
}
PageOldNum <- PageNewNum
}
goodsname <- NULL;goodsprice <- NULL;PageOldNum <- 1
repeat{
# 상품명
dom_name <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
Sys.sleep(1)
name <- sapply(dom_name, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
goodsname <- append(goodsname, name)
cat(length(goodsname), "\n")
# 상품 가격
dom_price <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.price > span")
Sys.sleep(1)
price <- sapply(dom_price, function (x) {x$getElementText()})
price <- gsub("[^0-9]", "", price)
print(price)
goodsprice <- append(goodsprice, name)
cat(length(goodsprice), "\n")
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
Sys.sleep(1)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
PageNewNum <- as.numeric(curr_PageElem$getElementText())
if(PageNewNum == PageOldNum)  {
cat("종료\n")
break;
}
PageOldNum <- PageNewNum
}
cat(length(goodsname))
cat(length(goodsprice))
df <- data.frame(goodsname, goodsprice)
write.csv(df, file='gs25_twotoone.csv')
goodsprice
twotoone <- remDr$findElements(using='css', '#TWO_TO_ONE')
remDr$executeScript("arguments[0].click();",twotoone)
goodsname <- NULL;goodsprice <- NULL;PageOldNum <- 1
repeat{
# 상품명
dom_name <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.tit")
Sys.sleep(1)
name <- sapply(dom_name, function (x) {x$getElementText()})
print(name)
name <- unlist(name)
goodsname <- append(goodsname, name)
cat(length(goodsname), "\n")
# 상품 가격
dom_price <- remDr$findElements(using = "css", "#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > ul > li > div > p.price > span")
Sys.sleep(1)
price <- sapply(dom_price, function (x) {x$getElementText()})
price <- gsub("[^0-9]", "", price)
print(price)
goodsprice <- append(goodsprice, price)
cat(length(goodsprice), "\n")
pageLink <- remDr$findElements(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > a.next')
remDr$executeScript("arguments[0].click();",pageLink)
Sys.sleep(1)
curr_PageElem <- remDr$findElement(using='css','#contents > div.cnt > div.cnt_section.mt50 > div > div > div:nth-child(5) > div > span > a.on')
PageNewNum <- as.numeric(curr_PageElem$getElementText())
if(PageNewNum == PageOldNum)  {
cat("종료\n")
break;
}
PageOldNum <- PageNewNum
}
cat(length(goodsname))
cat(length(goodsprice))
df <- data.frame(goodsname, goodsprice)
write.csv(df, file='gs25_twotoone.csv')
write.csv(df, file='gs25_twotoone.csv')
remDr <- remoteDriver(remoteServerAddr = "localhost", port = 4445, browserName = "chrome")
remDr$open()
remDr$navigate("http://www.yes24.com/24/goods/40936880")
#webElem <- remDr$findElement("css", "body")
#remDr$executeScript("scrollTo(0, 0)", args = list(webElem))
#Sys.sleep(1)
#remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
#Sys.sleep(1)
#remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
#Sys.sleep(1)
#remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
#Sys.sleep(3)
repl_v = NULL
endFlag <- FALSE
page <- 3
remDr$navigate("http://www.yes24.com/24/goods/40936880")
webElem <- remDr$findElement("css", "body")
remDr$executeScript("scrollTo(0, 0)", args = list(webElem))
Sys.sleep(1)
remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
Sys.sleep(1)
remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
Sys.sleep(1)
remDr$executeScript("scrollBy(0, 3200)", args = list(webElem))
Sys.sleep(3)
repl_v = NULL
endFlag <- FALSE
page <- 3
repeat {
for(index in 3:7) {
fullContentLinkCSS <- paste("#infoset_reviewContentList > div:nth-child(",index,") > div.reviewInfoBot.crop > a", sep='')
fullContentLink<-remDr$findElements(using='css selector',  fullContentLinkCSS)
if (length(fullContentLink) == 0) {
cat("종료\n")
endFlag <- TRUE
break
}
remDr$executeScript("arguments[0].click();",fullContentLink);
Sys.sleep(1)
fullContentCSS <- paste("#infoset_reviewContentList > div:nth-child(",index,") > div.reviewInfoBot.origin > div.review_cont > p", sep='')
fullContent<-remDr$findElements(using='css selector', fullContentCSS)
repl <-sapply(fullContent,function(x){x$getElementText()})
print(repl)
cat("---------------------\n")
repl_v <- c(repl_v, unlist(repl))
}
if(endFlag)
break;
if(page == 10){
page <- 3
nextPageCSS <- "#infoset_reviewContentList > div.review_sort.sortTop > div.review_sortLft > div > a.bgYUI.next"
}
else{
page <- page+1;
nextPageCSS <- paste("#infoset_reviewContentList > div.review_sort.sortBot > div.review_sortLft > div > a:nth-child(",page,")",sep="")
}
remDr$executeScript("scrollTo(0, 0)", args = list(webElem))
nextPageLink<-remDr$findElements(using='css selector',nextPageCSS)
remDr$executeScript("arguments[0].click();",nextPageLink);
#sapply(nextPageLink,function(x){x$clickElement()})
Sys.sleep(3)
print(page)
}
write(repl_v, "yes24.txt")
site <- paste("https://www.istarbucks.co.kr/store/store_map.do?disp=locale")
remDr$navigate(site)
remDr <- remoteDriver(remoteServerAddr = "localhost", port=4445, browserName="chrome")
remDr$open()
site <- paste("https://www.istarbucks.co.kr/store/store_map.do?disp=locale")
remDr$navigate(site)
#서울 클릭
btn1Css <- "#container > div > form > fieldset > div > section > article.find_store_cont > article > article:nth-child(4) > div.loca_step1 > div.loca_step1_cont > ul > li:nth-child(1) > a"
btn1Page <- remDr$findElements(using='css',btn1Css)
sapply(btn1Page,function(x){x$clickElement()})
#전체 클릭
btn2Css <- "#mCSB_2_container > ul > li:nth-child(1) > a"
btn2Page <- remDr$findElements(using='css',btn2Css)
sapply(btn2Page,function(x){x$clickElement()})
#서울 클릭
btn1Css <- "#container > div > form > fieldset > div > section > article.find_store_cont > article > article:nth-child(4) > div.loca_step1 > div.loca_step1_cont > ul > li:nth-child(1) > a"
btn1Page <- remDr$findElements(using='css',btn1Css)
sapply(btn1Page,function(x){x$clickElement()})
Sys.sleep(3)
#전체 클릭
btn2Css <- "#mCSB_2_container > ul > li:nth-child(1) > a"
btn2Page <- remDr$findElements(using='css',btn2Css)
sapply(btn2Page,function(x){x$clickElement()})
index <- 0
starbucks <- NULL
total <- sapply(remDr$findElements(using='css',"#container > div > form > fieldset > div > section > article.find_store_cont > article > article:nth-child(4) > div.loca_step3 > div.result_num_wrap > span"),function(x){x$getElementText()})
repeat{
index <- index + 1
print(index)
storeCss <- paste0("#mCSB_3_container > ul > li:nth-child(",index,")")
storePage <- remDr$findElements(using='css',storeCss)
if(length(storePage) == 0)
break
storeContent <- sapply(storePage,function(x){x$getElementText()})
#스타벅스 정보 추출
#strsplit(storeContent, split="\n")
storeList <- strsplit(unlist(storeContent), split="\n")
shopname <- storeList[[1]][1]
addr <- storeList[[1]][2]
addr <- gsub(",", "", addr)
telephone <- storeList[[1]][3]
#스타벅스 위도 경도 추출
lat <- sapply(storePage,function(x){x$getElementAttribute("data-lat")})
lng <- sapply(storePage,function(x){x$getElementAttribute("data-long")})
#병합
starbucks <- rbind(starbucks ,cbind(shopname, addr, telephone, lat, lng))
#스크롤 다운
if(index %% 3 == 0 && index != total)
remDr$executeScript("var dom=document.querySelectorAll('#mCSB_3_container > ul > li')[arguments[0]]; dom.scrollIntoView();", list(index))
}
write.csv(starbucks, "starbucks.csv")
